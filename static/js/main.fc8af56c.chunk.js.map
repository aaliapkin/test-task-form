{"version":3,"sources":["components/date-input/date-input.js","components/date-input/index.js","components/tel-input/tel-input.js","components/tel-input/index.js","components/form/form.js","components/form/index.js","index.js"],"names":["defaultDate","date","Date","now","d","getDate","slice","getMonth","getFullYear","getHours","getMinutes","formatDate","getTime","dateFieldToTimestamp","value","res","match","mo","y","h","mi","timestamp","parse","isNaN","CustomMaskedInput","forwardRef","props","ref","onChange","name","mask","maskPlaceholder","alwaysShowMask","e","persist","target","inputProps","type","className","DateInput","control","errors","React","useState","tel","setTel","as","rules","validate","inputTelRequired","v","undefined","today","validateDate","defaultValue","TelInput","required","ErrorMessage","message","Form","useForm","reValidateMode","handleSubmit","register","setError","clearErrors","isSubmitting","setSubmitting","onSubmit","values","a","data","id","phone","trim","replace","comment","console","log","JSON","stringify","fetch","method","headers","body","then","response","json","catch","setTimeout","Promise","resolve","disabled","htmlFor","maxLength","rows","agree","submit","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.fc8af56c.chunk.js","sourcesContent":["import React, { forwardRef } from \"react\";\r\nimport MaskedInput from \"react-input-mask\";\r\nimport { Controller } from \"react-hook-form\";\r\n\r\nfunction formatDate(d) {\r\n    const date = new Date(d);\r\n    return (\"0\" + (date.getDate())).slice(-2) + \".\" +\r\n        (\"0\" + (date.getMonth() + 1)).slice(-2) + \".\" +\r\n        date.getFullYear() + \" \" +\r\n        (\"0\" + (date.getHours())).slice(-2) + \":\" +\r\n        (\"0\" + (date.getMinutes())).slice(-2);\r\n}\r\n\r\nfunction defaultDate() {\r\n    const date = new Date(Date.now());\r\n    const tomorrow = new Date(date.getFullYear(), date.getMonth(), date.getDate() + 1, 0, 0);\r\n    return formatDate(tomorrow.getTime());\r\n}\r\n\r\nfunction validateDate(value) {\r\n    let timestamp = dateFieldToTimestamp(value);\r\n    if (timestamp === undefined) {\r\n        return 'Неверная дата';\r\n    }\r\n    const today = new Date(Date.now());\r\n    const date = new Date(timestamp);\r\n    if (date.getTime() < today.getTime()) {\r\n        return 'Неверная дата';\r\n    }\r\n    return true;\r\n}\r\n\r\nexport function dateFieldToTimestamp(value) {\r\n    const res = value.match(/^(\\d{2}).(\\d{2}).(\\d{4}) (\\d{2}):(\\d{2})$/);\r\n    if (res === null) {\r\n        return undefined;\r\n    }\r\n    const [, d, mo, y, h, mi] = res;\r\n    const timestamp = Date.parse(`${y}-${mo}-${d}T${h}:${mi}`);\r\n    if (isNaN(timestamp)) {\r\n        return undefined;\r\n    }\r\n    return timestamp;\r\n}\r\n\r\nconst CustomMaskedInput = forwardRef((props, ref) => {\r\n    const { value, onChange, name } = props;\r\n    return (\r\n        <MaskedInput\r\n            name={name}\r\n            value={value}\r\n            mask=\"99.99.9999 99:99\"\r\n            maskPlaceholder={\"_\"}\r\n            alwaysShowMask\r\n            onChange={e => {\r\n                e.persist();\r\n                onChange(e.target.value);\r\n            }}\r\n        >\r\n            {({ maskPlaceholder, ...inputProps }) => (\r\n                <input type=\"text\" name={inputProps.name} className=\"form-control\" {...inputProps} />\r\n            )}\r\n        </MaskedInput>\r\n    );\r\n});\r\n\r\nexport default function DateInput({ name, errors, control }) {\r\n\r\n    const [tel, setTel] = React.useState(defaultDate());\r\n\r\n    return (\r\n        <Controller\r\n            as={<CustomMaskedInput />}\r\n            value={tel}\r\n            onChange={([e]) => {\r\n                setTel(e);\r\n                return { value: e };\r\n            }}\r\n            rules={{\r\n                validate: {\r\n                    inputTelRequired: v => validateDate(v)\r\n                }\r\n            }}\r\n            defaultValue={tel}\r\n            name={name}\r\n            control={control}\r\n        />\r\n    );\r\n}\r\n","import DateInput, { dateFieldToTimestamp } from './date-input';\r\nexport default DateInput;\r\nexport { dateFieldToTimestamp };","import React, { forwardRef } from \"react\";\r\nimport MaskedInput from \"react-input-mask\";\r\nimport { Controller } from \"react-hook-form\";\r\n\r\nconst CustomMaskedInput = forwardRef((props, ref) => {\r\n    const { value, onChange, name } = props;\r\n    return (\r\n        <MaskedInput\r\n            name={name}\r\n            value={value}\r\n            mask=\"+7 (999) 999-9999\"\r\n            maskPlaceholder={\"_\"}\r\n            alwaysShowMask\r\n            onChange={e => {\r\n                e.persist();\r\n                onChange(e.target.value);\r\n            }}\r\n        >\r\n            {({ maskPlaceholder, ...inputProps }) => (\r\n                <input type=\"text\" name={inputProps.name} className=\"form-control\" {...inputProps} />\r\n            )}\r\n        </MaskedInput>\r\n    );\r\n});\r\n\r\nexport default function TelInput({ name, errors, control }) {\r\n\r\n    const [tel, setTel] = React.useState(\"\");\r\n\r\n    return (\r\n        <Controller\r\n            as={<CustomMaskedInput />}\r\n            value={tel}\r\n            onChange={([e]) => {\r\n                setTel(e);\r\n                return { value: e };\r\n            }}\r\n            rules={{\r\n                required: \"Необходимо указать телефон\"\r\n            }}\r\n            defaultValue={tel}\r\n            name={name}\r\n            control={control}\r\n        />\r\n    );\r\n}\r\n","import TelInput from './tel-input';\r\nexport default TelInput;","import React, { useState } from 'react';\r\nimport { useForm } from 'react-hook-form';\r\nimport DateInput, { dateFieldToTimestamp } from '../date-input/';\r\nimport TelInput from '../tel-input/';\r\n\r\nimport './form.scss';\r\n\r\nconst Form = (props) => {\r\n    const { handleSubmit, register, setError, clearErrors, errors, control } = useForm({ reValidateMode: 'onChange' });\r\n    const [isSubmitting, setSubmitting] = useState(false);\r\n\r\n    const onSubmit = async (values) => {\r\n        if (!isSubmitting) {\r\n            setSubmitting(true);\r\n            const data = {\r\n                id: 1,\r\n                data: {\r\n                    phone: values.phone.trim().replace(/\\D/g, '').replace(/^7/g, '+7'),\r\n                    date: dateFieldToTimestamp(values.date),\r\n                    comment: values.comment\r\n                }\r\n            }\r\n\r\n            //http://localhost:3001/requests\r\n            // const data = [{\r\n            //     phone: values.phone.trim().replace(/\\D/g, '').replace(/^7/g, '+7'),\r\n            //     date: dateFieldToTimestamp(values.date),\r\n            //     comment: values.comment\r\n            // }]\r\n\r\n            console.log(JSON.stringify(data));\r\n\r\n            // https://interview.gazilla-lounge.ru/api/submit\r\n            fetch('https://interview.gazilla-lounge.ru/api/submit', {\r\n                method: 'post',\r\n                headers: {\r\n                    \"Content-Type\": \"application/json\",\r\n                },\r\n                body: JSON.stringify(data)\r\n            }).then(response => response.json()\r\n            ).then(data => console.log(data)\r\n            ).catch(() => {\r\n                setError(\"submit\", { type: \"double_send\", message: \"Ошибка при обработке формы\" })\r\n                setTimeout(() => { clearErrors(\"submit\") }, 3000);\r\n            });\r\n\r\n            await new Promise(resolve => {\r\n                setTimeout(() => {\r\n                    setSubmitting(false);\r\n                    resolve();\r\n                }, 5000);\r\n            });\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"call-form__wrapper mx-auto container\">\r\n            <form onSubmit={handleSubmit(onSubmit)} className=\"call-form\" disabled={isSubmitting}>\r\n\r\n                <div className=\"form-group\">\r\n                    <label htmlFor=\"phone\">Номер телефона</label>\r\n                    <TelInput name=\"phone\" errors={errors} control={control} />\r\n                </div>\r\n\r\n                {errors.phone ? <ErrorMessage message={errors.phone.message} /> : ''}\r\n\r\n                <div className=\"form-group\">\r\n                    <label htmlFor=\"date\">Дата и время обратного звонка</label>\r\n                    <DateInput name=\"date\" errors={errors} control={control} />\r\n                </div>\r\n\r\n                {errors.date ? <ErrorMessage message={errors.date.message} /> : ''}\r\n\r\n                <div className=\"form-group\">\r\n                    <label htmlFor=\"comment\">Комментарий к заявке</label>\r\n                    <textarea\r\n                        name=\"comment\"\r\n                        id=\"comment\"\r\n                        maxLength=\"1024\"\r\n                        rows=\"6\"\r\n                        ref={register({\r\n                            maxLength: {\r\n                                value: 1024,\r\n                                message: \"Слишком длинный текст\"\r\n                            }\r\n                        })}\r\n                        className=\"form-control\"></textarea>\r\n                </div>\r\n\r\n                {errors.comment ? <ErrorMessage message={errors.comment.message} /> : ''}\r\n\r\n                <div className=\"input-group mb-3\">\r\n                    <div className=\"input-group-prepend\">\r\n                        <div className=\"input-group-text\">\r\n                            <input\r\n                                id=\"agree\"\r\n                                name=\"agree\"\r\n                                type=\"checkbox\"\r\n                                className=\"checkbox\"\r\n                                ref={register({\r\n                                    required: \"Необходимо согласиться с предоставлением услуги\"\r\n                                })} />\r\n                        </div>\r\n                    </div>\r\n                    <label htmlFor=\"agree\" className=\"form-control\">Согласен с предоставлением услуги</label>\r\n                </div>\r\n\r\n                {errors.agree ? <ErrorMessage message={errors.agree.message} /> : ''}\r\n\r\n                <input type=\"submit\" className=\"btn btn-primary\" value=\"Отправить заявку\" disabled={isSubmitting} />\r\n\r\n                {errors.submit ? <ErrorMessage message={errors.submit.message} /> : ''}\r\n\r\n            </form >\r\n        </div >\r\n    );\r\n};\r\n\r\nconst ErrorMessage = ({ message }) => {\r\n    return (\r\n        <div className=\"form-group call-form__error\">\r\n            {message}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Form;\r\n","import Form from './form';\r\n\r\nexport default Form;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.scss';\nimport Form from './components/form';\n\n\n\nReactDOM.render(<Form />, document.getElementById('root'));\n"],"sourceRoot":""}